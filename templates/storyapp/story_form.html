<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Story Generator</title>
    <style>
        body { font-family: Arial, sans-serif; background: #f4f4f4; margin: 0; padding: 0; }
        .container { max-width: 700px; margin: 40px auto; background: #fff; padding: 30px; border-radius: 8px; box-shadow: 0 2px 8px #ccc; }
        h1 { text-align: center; }
        textarea { width: 100%; height: 80px; margin-bottom: 20px; }
        button { padding: 10px 30px; font-size: 1.1em; border: none; background: #0078d7; color: #fff; border-radius: 4px; cursor: pointer; }
        .result { margin-top: 30px; }
        .section { margin-bottom: 25px; }
        .section h2 { margin-bottom: 8px; color: #0078d7; }
        .prompt-label { font-weight: bold; }
    </style>
</head>
<body>
<div class="container">
    <h1>Story & Character Generator</h1>
    <form method="post">
        {% csrf_token %}
        <label class="prompt-label" for="prompt">Enter your story prompt:</label><br>
        <textarea id="prompt" name="prompt" required>{{ prompt|default:'' }}</textarea><br>
        <button type="submit">Generate</button>
    </form>
    {% if generating %}
        <div class="result"><b>Generating story and images, please wait...</b></div>
    {% endif %}
    {% if story %}
    <div class="result">
        <div class="section">
            <h2>üåü Story</h2>
            <p>{{ story }}</p>
        </div>
        <div class="section" style="background: #fffbe6; border: 2px solid #ffd700; border-radius: 6px; padding: 16px;">
            <h2 style="color: #b8860b;">üìù Character Description</h2>
            <p style="font-weight: bold;">{{ char_description }}</p>
        </div>
        <div class="section">
            <h2>üìù Background Description</h2>
            <p>{{ bg_img_desc }}</p>
        </div>
        {% if final_image_url %}
        <div class="section">
            <h2>üé® Combined Image</h2>
            <img src="{{ final_image_url }}" alt="Combined Image" style="max-width:100%;border:1px solid #ccc;">
        </div>
        {% endif %}
        <div class="section" style="display:flex;gap:20px;">
            {% if char_image_url %}
            <div>
                <h3>Character Image</h3>
                <img src="{{ char_image_url }}" alt="Character" style="max-width:200px;border:1px solid #ccc;">
            </div>
            {% endif %}
            {% if bg_image_url %}
            <div>
                <h3>Background Image</h3>
                <img src="{{ bg_image_url }}" alt="Background" style="max-width:200px;border:1px solid #ccc;">
            </div>
            {% endif %}
        </div>
        {% if image_error %}
        <div class="section" style="color:red;">{{ image_error }}</div>
        {% endif %}
    </div>
    {% endif %}
</div>
</body>
</html>
